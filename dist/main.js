(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t,r){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,n(e,t,"set"),r),r}function n(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var r=new WeakMap,i=function(){function i(e){var n,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),a={writable:!0,value:{symbol:"",template:"",waitSignal:!1,cycleDuration:0,delay:0,price1:0,price2:0,levelCount:0,levels:[]}},function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(n=this,o=r),o.set(n,a),t(this,r,e)}var o,a;return o=i,(a=[{key:"current",get:function(){return function(e,t){return t.get?t.get.call(e):t.value}(this,n(this,r,"get"))}},{key:"update",set:function(e){t(this,r,e)}}])&&e(o.prototype,a),i}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,l(e,t,"set"),n),n}function l(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var c=new WeakMap,u=function(){function e(t){var n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i={writable:!0,value:[]},function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(n=this,r=c),r.set(n,i),a(this,c,t)}var t,n;return t=e,(n=[{key:"current",get:function(){return function(e,t){return t.get?t.get.call(e):t.value}(this,l(this,c,"get"))}},{key:"update",set:function(e){a(this,c,[]),a(this,c,e)}}])&&o(t.prototype,n),e}();function s(e){return'\n    <li class="list-group-item">\n        <div class="d-flex justify-content-between align-items-center">\n            <span class="align-middle">'.concat(e,'</span>\n            <div class="btn-group">\n                <button name="').concat(e,'" type="button" class="active cycle-state btn btn-sm btn-success me-4">Работает</button>\n                <button name="').concat(e,'" type="button" class="settings-orders btn btn-sm btn-primary me-4" data-bs-toggle="modal"\n                    data-bs-target="#pairSettings">Настройка</button>\n                <button name="').concat(e,'" type="button" class="close-orders btn btn-sm btn-warning me-4">Закрыть сделки</button>\n                <button name="').concat(e,'" type="button" class="delete-pair btn btn-sm btn-danger">Удалить</button>\n            </div>\n        </div>\n    </li>')}function d(e,t,n,r){return'\n    <div class="row">\n        <div class="col">\n            <div class="input-group mb-3">\n                <input id="profit" type="number" class="form-control" value="'.concat(t,'" aria-label="profit"\n                    aria-describedby="profit">\n            </div>\n        </div>\n        <div class="col">\n            <div class="input-group mb-3">\n                <input id="fibo-level" type="number" class="form-control" value="').concat(e,'" min="0" aria-label="Fibo level"\n                    aria-describedby="Fibo level">\n            </div>\n        </div>\n        <div class="col">\n            <div class="input-group mb-3">\n                <input id="takeprofit" type="number" class="form-control" value="').concat(n,'" min="0" aria-label="takeprofit"\n                    aria-describedby="takeprofit">\n            </div>\n        </div>\n        <div class="col">\n            <div class="input-group mb-3">\n                <input id="stoploss" type="number" class="form-control" value="').concat(r,'" min="0" aria-label="stoploss"\n                    aria-describedby="stoploss">\n            </div>\n        </div>\n    </div>')}function v(e,t){return'<option value="'.concat(e,'">').concat(t,"</option>")}var p="http://194.190.152.45:80/";function m(e,t){var n=new XMLHttpRequest;return n.open("GET",p+e,!1),n.setRequestHeader("Authorization","Bearer "+t),n.setRequestHeader("Access-Control-Allow-Origin","*"),n.send(),n.status>=200&&n.status<300?n.response:{status:n.status,statusText:n.statusText}}function y(e,t,n){var r=new XMLHttpRequest;return e=JSON.stringify(e),console.log("RequestBody: "+e),r.open("POST",p+t,!1),console.log(n),r.setRequestHeader("Content-Type","application/json; charset=utf-8"),r.setRequestHeader("Authorization","Bearer "+n),r.setRequestHeader("Access-Control-Allow-Origin","*"),r.send(e),r.status>=200&&r.status<300?r.response:{status:r.status,statusText:r.statusText}}function f(e,t,n,r){if(!t.every((function(t){return t.name!=e.name})))return alert("Такое имя темплейта уже существует"),!1;if(P({name:e.name,cycleDuration:e.cycleDuration,waitSignal:e.waitSignal,delay:e.delay,price1:e.price1,price2:e.price2,skipLevels:e.skipLevels,levelCount:e.levelCount,fiboContainer:e.fiboContainer})){for(var i=[],o=0;o<e.fiboContainer.childElementCount;o++){var a=e.fiboContainer.children[o],l={level:a.querySelector("#fibo-level").value,amount:a.querySelector("#profit").value,takeProfit:a.querySelector("#takeprofit").value,stopLoss:a.querySelector("#stoploss").value};i[o]=l}return delete e.fiboContainer,e.levels=i,e.cycleDuration=""==e.cycleDuration?"0m":e.cycleDuration+"m",e.delay+="m",e.skipLevels=Number(e.skipLevels),e.levelCount=Number(e.levelCount),console.log(e),y(e,"newTemplate",r),!0}}function S(e,t,n,r){if(!P({cycleDuration:e.cycleDuration,waitSignal:e.waitSignal,delay:e.delay,price1:e.price1,price2:e.price2,skipLevels:e.skipLevels,levelCount:e.levelCount,fiboContainer:e.fiboContainer}))return!1;for(var i=[],o=0;o<e.fiboContainer.childElementCount;o++){var a=e.fiboContainer.children[o],l={level:a.querySelector("#fibo-level").value,amount:a.querySelector("#profit").value,takeProfit:a.querySelector("#takeprofit").value,stopLoss:a.querySelector("#stoploss").value};i[o]=l}delete e.fiboContainer,e.levels=i;var c=new Promise((function(n,r){var i=function(e,t){var n=e,r="";return t.forEach((function(e){if(e.cycleType==n.cycleType&&e.timeframe==n.timeframe&&e.waitSignal==n.waitSignal&&e.cycleDuration==n.cycleDuration&&e.delay==n.delay&&e.skipPrice==n.skipPrice&&e.skipLevels==n.skipLevels&&e.stopPrice==n.stopPrice&&e.levelCount==n.levelCount)for(var t=0;t<e.levels.length;t++){var i=e.levels[t],o=n.levels[t];i.level==o.level&&i.amount==o.amount&&i.takeProfit==o.takeProfit&&i.stopLoss==o.stopLoss&&(r=e.name)}})),r}(e,t);e.template=i,n()}));c.then((function(){e.skipLevels=Number(e.skipLevels),e.levelCount=Number(e.levelCount),e.cycleDuration+="m",e.delay+="m",y(e,n,r)}))}function b(e,t){var n=document.querySelector("#pairSettings #cycle-duration"),r=document.querySelector("#pairSettings #waitSignal"),i=document.querySelector("#pairSettings #cycle-delay"),o=document.querySelector("#pairSettings #timeframe"),a=document.querySelector("#pairSettings #secondAlgorithm"),l=document.querySelector("#pairSettings #price1-fibo"),c=document.querySelector("#pairSettings #price2-fibo"),u=document.querySelector("#pairSettings #skip-levels"),s=document.querySelector("#pairSettings div.fibo-container"),v=document.querySelector("#pairSettings #orders-number");t&&T(e.template);for(var p=0;p<o.options.length;p++)if(o.options[p].text==e.timeframe){o.options[p].selected=!0;break}r.checked=e.waitSignal,n.value=e.cycleDuration,i.value=e.delay,a.checked="Alternative"==e.cycleType,l.value=e.stopPrice,c.value=e.skipPrice,u.value=e.skipLevels,v.value=e.levelCount,e.waitSignal?n.disabled=!0:n.disabled=!1,s.innerHTML="",e.levels.forEach((function(e){s.insertAdjacentHTML("beforeend",d(e.level,e.amount,e.takeProfit,e.stopLoss))}))}function g(e,t,n){e.innerHTML="";for(var r=0;r<n;r++){var i;if((null===(i=t.levels)||void 0===i?void 0:i.length)>r){var o=t.levels[r];e.insertAdjacentHTML("beforeend",d(o.level,o.amount,o.takeProfit,o.stopLoss))}else e.insertAdjacentHTML("beforeend",'\n    <div class="row">\n        <div class="col">\n            <div class="input-group mb-3">\n                <input id="profit" type="number" class="form-control" aria-label="profit"\n                    aria-describedby="profit">\n            </div>\n        </div>\n        <div class="col">\n            <div class="input-group mb-3">\n                <input id="fibo-level" type="number" class="form-control" min="0" aria-label="Fibo level"\n                    aria-describedby="Fibo level">\n            </div>\n        </div>\n        <div class="col">\n            <div class="input-group mb-3">\n                <input id="takeprofit" type="number" class="form-control" min="0" aria-label="takeprofit"\n                    aria-describedby="takeprofit">\n            </div>\n        </div>\n        <div class="col">\n            <div class="input-group mb-3">\n                <input id="stoploss" type="number" class="form-control" min="0" aria-label="stoploss"\n                    aria-describedby="stoploss">\n            </div>\n        </div>\n    </div>')}}function q(e,t){e.innerHTML='\n        <option value="none">Пустой</option>\n        <option value="default">Настройки пары</option>\n        ';for(var n=0;n<t.length;n++)e.insertAdjacentHTML("beforeend",v(n,t[n].name))}function w(e,t){e.innerHTML='\n        <option value="none">Пустой</option>\n        ';for(var n=0;n<t.length;n++)e.insertAdjacentHTML("beforeend",v(n,t[n].name))}function h(e,t){e.innerHTML="",t.length>0&&t.forEach((function(t){var n;console.log(t.name),e.insertAdjacentHTML("beforeend",(n=t.name,'\n        <li class="list-group-item">\n            <div class="d-flex justify-content-between align-items-center">\n                <span class="align-middle">'.concat(n,'</span>\n                <div class="btn-group">\n                    <button name="').concat(n,'" type="button"\n                        class="delete-template btn btn-sm btn-warning">Удалить</button>\n                </div>\n            </div>\n        </li>\n    ')))}))}function k(e,t){e.innerHTML="";for(var n=0;n<t.length;n++)e.insertAdjacentHTML("beforeend",(r=n,i=t[n],'<option value="'.concat(r,'">').concat(i,"</option>")));var r,i}function L(e){return console.log("{Formatter}"),"[object Array]"===Object.prototype.toString.call(e)?e.forEach((function(e){(e.delay.includes("m")||e.delay.includes("s"))&&(e.delay=e.delay.slice(0,-1)),(e.cycleDuration.includes("m")||e.cycleDuration.includes("s"))&&(e.cycleDuration=e.cycleDuration.slice(0,-1))})):((e.delay.includes("m")||e.delay.includes("s"))&&(e.delay=e.delay.slice(0,-1)),(e.cycleDuration.includes("m")||e.cycleDuration.includes("s"))&&(e.cycleDuration=e.cycleDuration.slice(0,-1))),console.log(e),e}function P(e){var t=e.fiboContainer;return""==(null==e?void 0:e.name)?(alert("Назавние темплейта не задано!"),!1):(""==e.cycleDuration||e.cycleDuration<0)&&0==e.waitSignal?(alert("Неверное продолжительность цикла"),!1):""==e.delay||e.delay<0?(alert("Неверное задержка"),!1):""==e.price1||e.price1<0?(alert("Неверное цена 1"),!1):""==e.price2||e.price2<0?(alert("Неверное цена 2"),!1):""==e.skipLevels||e.skipLevels<0?(alert("Неверное количество пропускаемых уровней при достижении цены 2"),!1):""==e.levelCount||e.levelCount<1?(alert("Неверное количество ордеров"),!1):A(t.querySelectorAll("#profit")).every((function(e){return""!=e.value}))?A(t.querySelectorAll("#fibo-level")).every((function(e){return""!=e.value&&e.value>0}))?A(t.querySelectorAll("#takeprofit")).every((function(e){return""!=e.value}))?!!A(t.querySelectorAll("#stoploss")).every((function(e){return""!=e.value}))||(alert("StopLoss задан неврено"),!1):(alert("TakeProfit задан неврено"),!1):(alert("Один из уровней срабатывания задан неверно"),!1):(alert("Один из объемов профита не задан"),!1)}function T(e){var t=document.querySelector("#pairSettings #pair-template");if(""==e)t.options[1].selected=!0;else for(var n=0;n<t.options.length;n++)if(t.options[n].text==e){t.options[n].selected=!0;break}}function A(e){return Array.prototype.slice.call(e)}document.addEventListener("DOMContentLoaded",(function(){var e,t,n=JSON.parse((e={password:"123"},"login",t=new XMLHttpRequest,e=JSON.stringify(e),console.log("RequestBody: "+e),t.open("POST",p+"login",!1),t.setRequestHeader("Content-Type","application/json; charset=utf-8"),t.setRequestHeader("Access-Control-Allow-Origin","*"),t.send(e),t.status>=200&&t.status<300?t.response:{status:t.status,statusText:t.statusText})).token;console.log("authToken:"+n);var r=new i,o=new u(L(JSON.parse(m("templates",n)))),a=document.querySelector("div.activePairs ul.list-group"),l=document.querySelector("#templates div.templates-container ul.list-group"),c=document.querySelector("div.manualTrading #active-pairs"),v=document.querySelector("div.newPair #available-pairs"),P=document.querySelector("div.newPair #pair-template"),T=document.querySelector("#pairSettings #pair-template"),A=document.getElementById("api-key-active"),C=JSON.parse(m("api",n));A.innerHTML=C.clientId,document.querySelector("#connectAPI #connect").addEventListener("click",(function(){var e=document.querySelector("#connectAPI #api-key"),t=document.querySelector("#connectAPI #secret-key");if(""!=e.value&&""!=t.value){y({clientId:e.value,clientSecret:t.value},"connectApi",n);var r=JSON.parse(m("api",n)).clientId;A.innerHTML=r}else alert("Ключи не заданы")})),document.querySelector("ul.navbar-nav #templatesList").addEventListener("click",(function(){h(l,o.current),document.querySelectorAll("#templates button.delete-template").forEach((function(e){!function(e,t){for(var n=e.cloneNode(!1);e.hasChildNodes();)n.appendChild(e.firstChild);e.parentNode.replaceChild(n,e)}(e)})),X(document.querySelectorAll("#templates button.delete-template"),l,T)}));var E=JSON.parse(m("activeSymbols",n));a.innerHTML="",E.length>0&&E.forEach((function(e){a.insertAdjacentHTML("beforeend",s(e))})),R(document.querySelectorAll("div.activePairs button.cycle-state")),I(document.querySelectorAll("button.settings-orders")),B(document.querySelectorAll("div.activePairs button.close-orders"));var H=document.querySelectorAll("div.activePairs button.delete-pair");F(a,H,n);var M=JSON.parse(m("availableSymbols",n));console.log("Availabale pairs: "+M),k(v,M),q(T,o.current),T.addEventListener("change",(function(){for(var e=document.querySelector("#pairSettings #pair-template"),t={},n=0;n<o.current.length;n++)if(e.selectedOptions[0].text==o.current[n].name){t=o.current[n];break}switch(T.selectedOptions[0].value){case"none":!function(){var e=document.querySelector("#pairSettings #cycle-duration"),t=document.querySelector("#pairSettings #waitSignal"),n=document.querySelector("#pairSettings #cycle-delay"),r=document.querySelector("#pairSettings #price1-fibo"),i=document.querySelector("#pairSettings #price2-fibo"),o=document.querySelector("#pairSettings #skip-levels"),a=document.querySelector("#pairSettings div.fibo-container"),l=document.querySelector("#pairSettings #orders-number");t.checked=!1,e.value="",n.value="",r.value="",i.value="",o.value="",l.value="",e.disabled=!1,a.innerHTML=""}();break;case"default":b(r.current);break;default:b(t)}}));var O=document.querySelector("#pairSettings #waitSignal"),N=document.querySelector("#pairSettings #cycle-duration");O.addEventListener("click",(function(){O.checked?N.disabled=!0:N.disabled=!1}));var D=document.querySelector("#pairSettings #orders-number");document.querySelector("#pairSettings button.choose-orders-number").addEventListener("click",(function(){var e=D.value;g(document.querySelector("#pairSettings div.fibo-container"),r.current,e)})),document.querySelector("#pairSettings button.saveTemplate").addEventListener("click",(function(){var e=document.querySelector("#pairSettings input.template-name"),t=document.querySelector("#pairSettings #timeframe"),r=document.querySelector("#pairSettings #cycle-duration"),i=document.querySelector("#pairSettings #waitSignal"),a=document.querySelector("#pairSettings #cycle-delay"),l=document.querySelector("#pairSettings #secondAlgorithm"),c=document.querySelector("#pairSettings #price1-fibo"),u=document.querySelector("#pairSettings #price2-fibo"),s=document.querySelector("#pairSettings #skip-levels"),d=document.querySelector("#pairSettings div.fibo-container"),v=document.querySelector("#pairSettings #orders-number");f({name:e.value,cycleType:l.checked?"Alternative":"Normal",timeframe:t.selectedOptions[0].text,waitSignal:i.checked,cycleDuration:r.value,delay:a.value,stopPrice:c.value,skipPrice:u.value,skipLevels:s.value,levelCount:v.value,fiboContainer:d},o.current,0,n)&&(o.update=L(JSON.parse(m("templates",n))),w(P,o.current),q(T,o.current))})),document.querySelector("#pairSettings #save").addEventListener("click",(function(){var e=document.querySelector("#pairSettings span.pair"),t=document.querySelector("#pairSettings #timeframe"),r=document.querySelector("#pairSettings #cycle-duration"),i=document.querySelector("#pairSettings #waitSignal"),a=document.querySelector("#pairSettings #cycle-delay"),l=document.querySelector("#pairSettings #secondAlgorithm"),c=document.querySelector("#pairSettings #price1-fibo"),u=document.querySelector("#pairSettings #price2-fibo"),s=document.querySelector("#pairSettings #skip-levels"),d=document.querySelector("#pairSettings div.fibo-container"),v=document.querySelector("#pairSettings #orders-number");S({symbol:e.innerText,template:"",cycleType:l.checked?"Alternative":"Normal",timeframe:t.selectedOptions[0].text,waitSignal:i.checked,cycleDuration:r.value,delay:a.value,stopPrice:c.value,skipPrice:u.value,skipLevels:s.value,levelCount:v.value,fiboContainer:d},o.current,"newSymbol",n)})),document.querySelector("div.schedule button.sendTime").addEventListener("click",(function(){var e=document.querySelector("div.schedule input.time-from"),t=document.querySelector("div.schedule input.time-to");if(""!=e.value&&""!=t.value){var r=e.value.split(":"),i=t.value.split(":"),o=60*Number(r[0])+Number(r[1]),a=60*Number(i[0])+Number(i[1]);console.log("form: "+o),console.log("to: "+a);var l={from:o+"m",to:a+"m"};y(l,"setTime",n),console.log(l),console.log("Send request to /setTime")}else alert("Время работы скрипта не задано")})),c.innerHTML="",E.forEach((function(e){c.insertAdjacentHTML("beforeend",'\n            <option value="'.concat(e,'">').concat(e,"</option>\n        "))})),document.querySelector("div.manualTrading button.sendSignal").addEventListener("click",(function(){var e=document.querySelector("div.manualTrading #active-pairs"),t=document.querySelector("div.manualTrading input.minimum-price"),r=document.querySelector("div.manualTrading input.maximum-price"),i=document.querySelector("div.manualTrading #impulseDirection");if(""==t.value||t.value<0||""==r.value||r.value<0)alert("Минимальная или максимальная цена заданы неверно");else{var o={symbol:e.selectedOptions[0].text,type:i.selectedOptions[0].text.toLocaleLowerCase(),minPrice:t.value,maxPrice:r.value};y(o,"startCycle",n),console.log(o),console.log("Send request to /startCycle")}})),w(P,o.current),P.addEventListener("change",(function(){for(var e=document.querySelector("div.newPair #pair-template"),t={},n=0;n<o.current.length;n++)if(e.selectedOptions[0].text==o.current[n].name){t=o.current[n];break}"none"===P.selectedOptions[0].value?function(){var e=document.querySelector("div.newPair #cycle-duration"),t=document.querySelector("div.newPair #waitSignal"),n=document.querySelector("div.newPair #cycle-delay"),r=document.querySelector("div.newPair #price1-fibo"),i=document.querySelector("div.newPair #price2-fibo"),o=document.querySelector("div.newPair #skip-levels"),a=document.querySelector("div.newPair div.fibo-container"),l=document.querySelector("div.newPair #orders-number");t.checked=!1,e.value="",n.value="",r.value="",i.value="",o.value="",l.value="",e.disabled=!1,a.innerHTML=""}():function(e,t){console.log(e);for(var n=document.querySelector("div.newPair #cycle-duration"),r=document.querySelector("div.newPair #waitSignal"),i=document.querySelector("div.newPair #cycle-delay"),o=document.querySelector("div.newPair #timeframe"),a=document.querySelector("div.newPair #secondAlgorithm"),l=document.querySelector("div.newPair #price1-fibo"),c=document.querySelector("div.newPair #price2-fibo"),u=document.querySelector("div.newPair #skip-levels"),s=document.querySelector("div.newPair div.fibo-container"),v=document.querySelector("div.newPair #orders-number"),p=0;p<o.options.length;p++)if(o.options[p].text==e.timeframe){o.options[p].selected=!0;break}r.checked=e.waitSignal,n.value=e.cycleDuration,i.value=e.delay,a.checked="Alternative"==e.cycleType,l.value=e.stopPrice,c.value=e.skipPrice,u.value=e.skipLevels,v.value=e.levelCount,e.waitSignal?n.disabled=!0:n.disabled=!1,s.innerHTML="",e.levels.forEach((function(e){s.insertAdjacentHTML("beforeend",d(e.level,e.amount,e.takeProfit,e.stopLoss))}))}(t)}));var j=document.querySelector("div.newPair #waitSignal"),x=document.querySelector("div.newPair #cycle-duration");j.addEventListener("click",(function(){j.checked?x.disabled=!0:x.disabled=!1}));var J=document.querySelector("div.newPair #orders-number");function R(e){e.forEach((function(e){e.addEventListener("click",(function(){e.classList.toggle("active"),e.classList.toggle("btn-dark"),e.classList.toggle("btn-success"),e.classList.contains("active")?(e.innerHTML="Работает",y({symbol:e.name},"pauseCycle",n)):(y({symbol:e.name},"pauseCycle",n),e.innerHTML="Остановлено")}))}))}function I(e){e.forEach((function(e){e.addEventListener("click",(function(){r.update=L(JSON.parse(m("symbols?symbol=".concat(e.name),n))),document.querySelector("#pairSettings span.pair").innerHTML=r.current.symbol,b(r.current,!0)}))}))}function B(e){e.forEach((function(e){e.addEventListener("click",(function(){confirm("Закрыть ордера?")&&y({symbol:e.name},"stopCycle",n)}))}))}function F(e,t,n){t.forEach((function(t){t.addEventListener("click",(function(){if(confirm("Вы уверены, что хотите удалить пару?")){y({symbol:t.name},"deleteSymbol",n);var r=JSON.parse(m("activeSymbols",n));e.innerHTML="",r.length>0&&r.forEach((function(t){e.insertAdjacentHTML("beforeend",s(t))})),z();var i=e.querySelectorAll("button.delete-pair");F(e,i,n);var o=document.querySelector("div.manualTrading #active-pairs");o.innerHTML="",r.forEach((function(e){o.insertAdjacentHTML("beforeend",'\n                        <option value="'.concat(e,'">').concat(e,"</option>\n                    "))}));var a=JSON.parse(m("availableSymbols",n));k(v,a)}}))}))}function z(){var e=document.querySelectorAll("div.activePairs button.cycle-state"),t=document.querySelectorAll("button.settings-orders"),n=document.querySelectorAll("div.activePairs button.close-orders");R(e),I(t),B(n)}function X(e,t,r){e.forEach((function(e){e.addEventListener("click",(function(){y({templateName:e.name},"deleteTemplate",n),o.update=L(JSON.parse(m("templates",n))),h(t,o.current),w(P,o.current),q(r,o.current),X(document.querySelectorAll("#templates button.delete-template"),t,r)}))}))}document.querySelector("div.newPair button.choose-orders-number").addEventListener("click",(function(){var e=J.value;g(document.querySelector("div.newPair div.fibo-container"),{},e)})),document.querySelector("div.newPair button.saveTemplate").addEventListener("click",(function(){var e=document.querySelector("div.newPair input.template-name"),t=document.querySelector("div.newPair #timeframe"),r=document.querySelector("div.newPair #cycle-duration"),i=document.querySelector("div.newPair #waitSignal"),a=document.querySelector("div.newPair #cycle-delay"),l=document.querySelector("div.newPair #secondAlgorithm"),c=document.querySelector("div.newPair #price1-fibo"),u=document.querySelector("div.newPair #price2-fibo"),s=document.querySelector("div.newPair #skip-levels"),d=document.querySelector("div.newPair div.fibo-container"),v=document.querySelector("div.newPair  #orders-number");f({name:e.value,cycleType:l.checked?"Alternative":"Normal",timeframe:t.selectedOptions[0].text,waitSignal:i.checked,cycleDuration:r.value,delay:a.value,stopPrice:c.value,skipPrice:u.value,skipLevels:s.value,levelCount:v.value,fiboContainer:d},o.current,0,n),o.update=L(JSON.parse(m("templates",n))),w(P,o.current),q(T,o.current)})),document.querySelector("div.newPair #addNewPair").addEventListener("click",(function(){var e=document.querySelector("div.newPair #available-pairs"),t=document.querySelector("div.newPair #timeframe"),r=document.querySelector("div.newPair #cycle-duration"),i=document.querySelector("div.newPair #waitSignal"),l=document.querySelector("div.newPair #cycle-delay"),u=document.querySelector("div.newPair #secondAlgorithm"),d=document.querySelector("div.newPair #price1-fibo"),p=document.querySelector("div.newPair #price2-fibo"),y=document.querySelector("div.newPair #skip-levels"),f=document.querySelector("div.newPair div.fibo-container"),b=document.querySelector("div.newPair #orders-number");S({symbol:e.selectedOptions[0].text,template:"",cycleType:u.checked?"Alternative":"Normal",timeframe:t.selectedOptions[0].text,waitSignal:i.checked,cycleDuration:r.value,delay:l.value,stopPrice:d.value,skipPrice:p.value,skipLevels:y.value,levelCount:b.value,fiboContainer:f},o.current,"newSymbol",n);var g=JSON.parse(m("activeSymbols",n));console.log(g),a.innerHTML="",g.length>0&&g.forEach((function(e){a.insertAdjacentHTML("beforeend",s(e))})),z();var q=a.querySelectorAll("button.delete-pair");F(a,q,n),c.innerHTML="",g.forEach((function(e){c.insertAdjacentHTML("beforeend",'\n                    <option value="'.concat(e,'">').concat(e,"</option>\n                "))}));var w=JSON.parse(m("availableSymbols",n));k(v,w)})),document.querySelector("div.actions #close-orders-all").addEventListener("click",(function(){confirm("Вы уверены, что хотите закрыть все сделки?")&&m("closeAllOrders",n)}))}))})();